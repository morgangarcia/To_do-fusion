{"version":3,"file":"browser.es5.js","sources":["../src/modules/Status.js","../src/modules/Redirect.js","../src/modules/ServerRouter.js","../src/modules/Route.js","../src/server.js","../src/modules/BrowserRouter.js","../src/browser.js","../src/plugin.js","../src/index.js"],"sourcesContent":["/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nexport class Status extends React.Component<any> {\n  constructor(props: any, context: any) {\n    super(props, context);\n    const {\n      router: {staticContext},\n    } = context;\n    if (staticContext && staticContext.setCode) {\n      staticContext.setCode(parseInt(this.props.code, 10));\n    }\n  }\n\n  render() {\n    const children = this.props && this.props.children;\n    return Array.isArray(children) ? children[0] : children;\n  }\n}\n\nStatus.contextTypes = {\n  router: PropTypes.shape({\n    staticContext: PropTypes.object,\n  }),\n};\n\nexport const NotFound = (props: any) => (\n  <Status code={404}>{props.children}</Status>\n);\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nexport class Redirect extends React.Component<any> {\n  constructor(props: any, context: any) {\n    super(props, context);\n    if (this.isStatic(context)) this.perform();\n  }\n\n  componentDidMount() {\n    if (!this.isStatic()) this.perform();\n  }\n\n  isStatic(context: any = this.context) {\n    return context.router && context.router.staticContext;\n  }\n\n  perform() {\n    const {history, staticContext} = this.context.router;\n    const {push, to, code} = this.props;\n\n    if (__NODE__ && staticContext) {\n      staticContext.setCode(parseInt(code, 10));\n      staticContext.redirect(to);\n      return;\n    }\n\n    if (push) {\n      history.push(to);\n    } else {\n      history.replace(to);\n    }\n  }\n\n  render() {\n    return null;\n  }\n}\n\n// $FlowFixMe\nRedirect.defaultProps = {\n  push: false,\n  code: 307,\n};\n\nRedirect.contextTypes = {\n  router: PropTypes.shape({\n    history: PropTypes.shape({\n      push: PropTypes.func.isRequired,\n      replace: PropTypes.func.isRequired,\n    }).isRequired,\n    staticContext: PropTypes.object,\n  }).isRequired,\n};\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport React from 'react';\nimport {createPath, parsePath} from 'history';\nimport {Router} from 'react-router-dom';\n\nconst addLeadingSlash = path => (path.charAt(0) === '/' ? path : '/' + path);\n\n/**\n * @param {string|object} location\n * @param {string} prefix\n * @returns {object}\n */\nconst addRoutePrefix = (location, prefix) => {\n  if (!prefix) return location;\n  if (typeof location === 'string') {\n    return `${prefix}${addLeadingSlash(location)}`;\n  } else {\n    return {\n      ...location,\n      pathname: `${prefix}${addLeadingSlash(location.pathname)}`,\n    };\n  }\n};\n\n/**\n * @param {string|object} location\n * @param {string} prefix\n * @returns {object}\n */\nconst removeRoutePrefix = (location, prefix) => {\n  if (!prefix) return location;\n  const pathname = typeof location === 'string' ? location : location.pathname;\n  const hasPrefix = (pathname + '/').indexOf(prefix + '/') === 0;\n  const unprefixedPathname = pathname.slice(prefix.length);\n  const relativePathname = hasPrefix ? unprefixedPathname : pathname;\n\n  if (typeof location === 'string') {\n    return relativePathname;\n  } else {\n    return {\n      ...location,\n      pathname: relativePathname,\n    };\n  }\n};\n\n/**\n * @param {string} path\n * @param {string} prefix\n * @returns {object}\n */\nconst createLocation = (path, prefix) => {\n  const unprefixedPath = removeRoutePrefix(path, prefix);\n  return parsePath(unprefixedPath);\n};\n\n/**\n * @param {string|object} location\n * @param {string} prefix\n * @returns {string}\n */\nconst createPrefixedURL = (location, prefix) => {\n  if (typeof location === 'string') {\n    return addRoutePrefix(location, prefix);\n  } else {\n    return createPath(addRoutePrefix(location, prefix));\n  }\n};\n\n/**\n * @param {string|object} location\n * @param {string} prefix\n * @returns {string}\n */\nconst createURL = (location, prefix) => {\n  if (typeof location === 'string') {\n    return removeRoutePrefix(location, prefix);\n  } else {\n    return createPath(removeRoutePrefix(location, prefix));\n  }\n};\n\nconst staticHandler = methodName => () => {\n  throw new Error(`You cannot ${methodName} with server side <Router>`);\n};\n\nconst noop = () => {};\n\n/**\n * The public top-level API for a \"static\" <Router>, so-called because it\n * can't actually change the current location. Instead, it just records\n * location changes in a context object. Useful mainly in testing and\n * server-rendering scenarios.\n */\nexport class ServerRouter extends React.Component<any> {\n  getChildContext() {\n    return {\n      router: {\n        staticContext: this.props.context || {},\n      },\n      onRoute: (routeData: any) => this.props.onRoute(routeData),\n    };\n  }\n\n  /**\n   * @param {string|object} location\n   * @returns {string}\n   */\n  createHref(location: any) {\n    return createPrefixedURL(location, this.props.basename);\n  }\n\n  /**\n   * @param {string} path\n   */\n  handlePush(path: any) {\n    const {basename, context} = this.props;\n    context.action = 'PUSH';\n    context.location = createLocation(path, basename);\n    context.url = createURL(path, basename);\n  }\n\n  /**\n   * @param {string} path\n   */\n  handleReplace(path: any) {\n    const {basename, context} = this.props;\n    context.action = 'REPLACE';\n    context.location = createLocation(path, basename);\n    context.url = createURL(path, basename);\n  }\n\n  handleListen() {\n    return noop;\n  }\n\n  render() {\n    /* eslint-disable no-unused-vars */\n    const {context, location, ...props} = this.props;\n    /* eslint-enable no-unused-vars */\n    const history = {\n      createHref: this.createHref.bind(this),\n      action: 'POP',\n      location: createLocation(location, this.props.basename),\n      push: this.handlePush.bind(this),\n      replace: this.handleReplace.bind(this),\n      go: staticHandler('go'),\n      back: staticHandler('back'),\n      forward: staticHandler('forward'),\n      listen: this.handleListen,\n    };\n\n    return <Router {...props} history={history} />;\n  }\n}\n\n// $FlowFixMe\nServerRouter.defaultProps = {\n  basename: '',\n  location: '/',\n  context: {},\n  onRoute: () => {},\n};\n\nServerRouter.childContextTypes = {\n  router: () => {},\n  onRoute: () => {},\n};\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {Route as ReactRouterRoute} from 'react-router-dom';\n\nconst isEmptyChildren = children => React.Children.count(children) === 0;\n\nfunction Route(props: any, context: any) {\n  const {trackingId, component, render, children, ...remainingProps} = props;\n\n  return (\n    <ReactRouterRoute\n      {...remainingProps}\n      // eslint-disable-next-line react/no-children-prop\n      children={routeProps => {\n        const {match} = routeProps;\n        if (match && match.isExact) {\n          context.onRoute({\n            page: match.path,\n            title: trackingId || match.path,\n          });\n        }\n\n        if (component)\n          return match ? React.createElement(component, routeProps) : null;\n\n        if (render) return match ? render(routeProps) : null;\n\n        if (typeof children === 'function') return children(routeProps);\n\n        if (children && !isEmptyChildren(children))\n          return React.Children.only(children);\n\n        return null;\n      }}\n    />\n  );\n}\n\nRoute.contextTypes = {\n  onRoute: PropTypes.func.isRequired,\n};\n\nRoute.displayName = 'FusionRoute';\n\nexport {Route};\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport {\n  BrowserRouter,\n  HashRouter,\n  Link,\n  MemoryRouter,\n  NavLink,\n  Prompt,\n  Router as _Router,\n  Switch,\n  matchPath,\n  withRouter,\n} from 'react-router-dom';\n\nimport {Status, NotFound} from './modules/Status';\nimport {Redirect} from './modules/Redirect';\nimport {ServerRouter as Router} from './modules/ServerRouter';\nimport {Route} from './modules/Route';\n\nexport {\n  BrowserRouter,\n  HashRouter,\n  Link,\n  MemoryRouter,\n  NavLink,\n  Prompt,\n  _Router,\n  Switch,\n  matchPath,\n  withRouter,\n  Status,\n  NotFound,\n  Redirect,\n  Router,\n  Route,\n};\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {Router as BaseRouter} from 'react-router-dom';\nimport createHistory from 'history/createBrowserHistory';\n\nexport {Status, NotFound} from './Status';\nexport {Redirect} from './Redirect';\n\nclass BrowserRouter extends React.Component<any> {\n  history: any;\n  lastTitle: any;\n\n  constructor(props: any = {}, context: any) {\n    super(props, context);\n    this.history = createHistory(this.props);\n    this.lastTitle = null;\n  }\n\n  getChildContext() {\n    const {__IS_PREPARE__} = this.context;\n    return {\n      onRoute: (routeData: any) => {\n        if (routeData.title !== this.lastTitle && !__IS_PREPARE__) {\n          this.lastTitle = routeData.title;\n          this.props.onRoute(routeData);\n        }\n      },\n    };\n  }\n\n  render() {\n    return (\n      <BaseRouter history={this.history}>{this.props.children}</BaseRouter>\n    );\n  }\n}\n\nBrowserRouter.propTypes = {\n  basename: PropTypes.string,\n  forceRefresh: PropTypes.bool,\n  getUserConfirmation: PropTypes.func,\n  keyLength: PropTypes.number,\n  children: PropTypes.node,\n  onRoute: PropTypes.func,\n};\n\nBrowserRouter.contextTypes = {\n  __IS_PREPARE__: PropTypes.bool,\n};\n\nBrowserRouter.childContextTypes = {\n  onRoute: PropTypes.func.isRequired,\n};\n\n// $FlowFixMe\nBrowserRouter.defaultProps = {\n  onRoute: () => {},\n};\n\nexport {BrowserRouter as Router};\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport {\n  BrowserRouter,\n  HashRouter,\n  Link,\n  MemoryRouter,\n  NavLink,\n  Prompt,\n  StaticRouter,\n  Switch,\n  matchPath,\n  withRouter,\n} from 'react-router-dom';\n\nimport {Status, NotFound} from './modules/Status';\nimport {Redirect} from './modules/Redirect';\nimport {Router} from './modules/BrowserRouter';\nimport {Route} from './modules/Route';\n\nexport {\n  BrowserRouter,\n  HashRouter,\n  Link,\n  MemoryRouter,\n  NavLink,\n  Prompt,\n  StaticRouter,\n  Switch,\n  matchPath,\n  withRouter,\n  Status,\n  NotFound,\n  Redirect,\n  Router,\n  Route,\n};\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport {UniversalEventsToken} from 'fusion-plugin-universal-events';\nimport React from 'react';\nimport {createPlugin, html, unescape} from 'fusion-core';\nimport {Router as ServerRouter} from './server';\nimport {Router as BrowserRouter} from './browser';\n\nconst Router = __NODE__ ? ServerRouter : BrowserRouter;\nexport default createPlugin({\n  deps: {\n    emitter: UniversalEventsToken.optional,\n  },\n  middleware: ({emitter}) => {\n    return async (ctx, next) => {\n      const prefix = ctx.prefix || '';\n      if (!ctx.element) {\n        return next();\n      }\n      if (__NODE__) {\n        let pageData = {\n          title: ctx.path,\n          page: ctx.path,\n        };\n        const context = {\n          setCode: code => {\n            ctx.status = code;\n          },\n          redirect: url => {\n            ctx.redirect(url);\n          },\n        };\n        ctx.element = (\n          <Router\n            onRoute={d => {\n              pageData = d;\n            }}\n            basename={prefix}\n            location={prefix + ctx.url}\n            context={context}\n          >\n            {ctx.element}\n          </Router>\n        );\n        return next().then(() => {\n          ctx.template.body.push(\n            html`<script id=\"__ROUTER_DATA__\" type=\"application/json\">${JSON.stringify(\n              pageData\n            )}</script>`\n          );\n\n          if (emitter) {\n            const emitTiming = type => timing => {\n              emitter.emit(type, {\n                title: pageData.title,\n                page: pageData.page,\n                status: ctx.status,\n                timing,\n              });\n            };\n            emitter.map(payload => {\n              if (payload && typeof payload === 'object') {\n                payload.__url__ = pageData.title;\n              }\n              return payload;\n            });\n            ctx.timing.end.then(timing => {\n              emitTiming('pageview:server')(timing);\n              ctx.timing.render.then(emitTiming('render:server'));\n            });\n          }\n        });\n      } else if (__BROWSER__) {\n        // TODO(#3): We should consider adding render/downstream/upstream timings for the browser\n        let pageData = {};\n        const element = document.getElementById('__ROUTER_DATA__');\n        if (element) {\n          pageData = JSON.parse(unescape(element.textContent));\n        }\n        emitter &&\n          emitter.map(payload => {\n            if (payload && typeof payload === 'object') {\n              payload.__url__ = pageData.title;\n            }\n            return payload;\n          });\n        ctx.element = (\n          <Router\n            basename={ctx.prefix}\n            onRoute={payload => {\n              pageData = payload;\n              emitter && emitter.emit('pageview:browser', payload);\n            }}\n          >\n            {ctx.element}\n          </Router>\n        );\n        return next();\n      }\n    };\n  },\n});\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport plugin from './plugin';\nimport * as server from './server';\nimport * as browser from './browser';\n\ndeclare var __BROWSER__: Boolean;\nconst BrowserRouter = __BROWSER__\n  ? browser.BrowserRouter\n  : server.BrowserRouter;\nconst HashRouter = __BROWSER__ ? browser.HashRouter : server.HashRouter;\nconst Link = __BROWSER__ ? browser.Link : server.Link;\nconst matchPath = __BROWSER__ ? browser.matchPath : server.matchPath;\nconst MemoryRouter = __BROWSER__ ? browser.MemoryRouter : server.MemoryRouter;\nconst NavLink = __BROWSER__ ? browser.NavLink : server.NavLink;\nconst Prompt = __BROWSER__ ? browser.Prompt : server.Prompt;\nconst Route = __BROWSER__ ? browser.Route : server.Route;\nconst Router = __BROWSER__ ? browser.Router : server.Router;\nconst Switch = __BROWSER__ ? browser.Switch : server.Switch;\nconst withRouter = __BROWSER__ ? browser.withRouter : server.withRouter;\n\nconst NotFound = __BROWSER__ ? browser.NotFound : server.NotFound;\nconst Redirect = __BROWSER__ ? browser.Redirect : server.Redirect;\nconst Status = __BROWSER__ ? browser.Status : server.Status;\n\nexport default plugin;\nexport {\n  BrowserRouter,\n  HashRouter,\n  Link,\n  matchPath,\n  MemoryRouter,\n  NavLink,\n  NotFound,\n  Prompt,\n  Redirect,\n  Route,\n  Router,\n  Status,\n  Switch,\n  withRouter,\n};\n"],"names":["Status","props","context","staticContext","router","setCode","parseInt","code","render","children","Array","isArray","React","Component","contextTypes","PropTypes","shape","object","NotFound","Redirect","isStatic","perform","componentDidMount","history","push","to","replace","defaultProps","func","isRequired","addLeadingSlash","path","charAt","addRoutePrefix","location","prefix","pathname","removeRoutePrefix","hasPrefix","indexOf","unprefixedPathname","slice","length","relativePathname","createLocation","unprefixedPath","parsePath","createPrefixedURL","createPath","createURL","staticHandler","Error","methodName","noop","ServerRouter","getChildContext","routeData","onRoute","createHref","basename","handlePush","action","url","handleReplace","handleListen","bind","Router","childContextTypes","isEmptyChildren","Children","count","Route","trackingId","component","remainingProps","ReactRouterRoute","match","routeProps","isExact","createElement","only","displayName","BrowserRouter","createHistory","lastTitle","__IS_PREPARE__","title","BaseRouter","propTypes","string","bool","number","node","createPlugin","UniversalEventsToken","optional","emitter","ctx","next","element","pageData","document","getElementById","JSON","parse","unescape","textContent","map","payload","__url__","emit","browser","HashRouter","Link","matchPath","MemoryRouter","NavLink","Prompt","Switch","withRouter"],"mappings":"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"}
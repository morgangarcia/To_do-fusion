{"version":3,"file":"node.js","sources":["../src/hyphenate-style-name.js","../src/validate-no-mixed-hand.js","../src/__tests__/test.node.js","../src/sequential-id-generator.js","../src/cache.js","../src/inject-style-prefixed.js","../src/css.js","../src/server/server.js","../src/server/__tests__/tests.node.js"],"sourcesContent":["// @flow\n\nconst uppercasePattern = /[A-Z]/g;\nconst msPattern = /^ms-/;\nconst cache = {};\n\nexport default function hyphenateStyleName(prop: string): string {\n  return prop in cache\n    ? cache[prop]\n    : (cache[prop] = prop\n        .replace(uppercasePattern, \"-$&\")\n        .toLowerCase()\n        .replace(msPattern, \"-ms-\"));\n}\n","// @flow\n\n/**\n * Adapted from https://github.com/gilmoreorless/css-shorthand-properties\n */\n\nimport hyphenate from \"./hyphenate-style-name.js\";\n\nconst shorthandMap = {\n  // CSS 2.1: https://www.w3.org/TR/CSS2/propidx.html\n  \"list-style\": [\"list-style-type\", \"list-style-position\", \"list-style-image\"],\n  margin: [\"margin-top\", \"margin-right\", \"margin-bottom\", \"margin-left\"],\n  outline: [\"outline-width\", \"outline-style\", \"outline-color\"],\n  padding: [\"padding-top\", \"padding-right\", \"padding-bottom\", \"padding-left\"],\n\n  // CSS Backgrounds and Borders Module Level 3: https://www.w3.org/TR/css3-background/\n  background: [\n    \"background-image\",\n    \"background-position\",\n    \"background-size\",\n    \"background-repeat\",\n    \"background-origin\",\n    \"background-clip\",\n    \"background-attachment\",\n    \"background-color\",\n  ],\n  border: [\n    \"border-top-width\",\n    \"border-right-width\",\n    \"border-bottom-width\",\n    \"border-left-width\",\n    \"border-width\",\n    \"border-top-style\",\n    \"border-right-style\",\n    \"border-bottom-style\",\n    \"border-left-style\",\n    \"border-style\",\n    \"border-top-color\",\n    \"border-right-color\",\n    \"border-bottom-color\",\n    \"border-left-color\",\n    \"border-color\",\n  ],\n  \"border-color\": [\n    \"border-top-color\",\n    \"border-right-color\",\n    \"border-bottom-color\",\n    \"border-left-color\",\n  ],\n  \"border-style\": [\n    \"border-top-style\",\n    \"border-right-style\",\n    \"border-bottom-style\",\n    \"border-left-style\",\n  ],\n  \"border-width\": [\n    \"border-top-width\",\n    \"border-right-width\",\n    \"border-bottom-width\",\n    \"border-left-width\",\n  ],\n  \"border-top\": [\"border-top-width\", \"border-top-style\", \"border-top-color\"],\n  \"border-right\": [\n    \"border-right-width\",\n    \"border-right-style\",\n    \"border-right-color\",\n  ],\n  \"border-bottom\": [\n    \"border-bottom-width\",\n    \"border-bottom-style\",\n    \"border-bottom-color\",\n  ],\n  \"border-left\": [\n    \"border-left-width\",\n    \"border-left-style\",\n    \"border-left-color\",\n  ],\n  \"border-radius\": [\n    \"border-top-left-radius\",\n    \"border-top-right-radius\",\n    \"border-bottom-right-radius\",\n    \"border-bottom-left-radius\",\n  ],\n  \"border-image\": [\n    \"border-image-source\",\n    \"border-image-slice\",\n    \"border-image-width\",\n    \"border-image-outset\",\n    \"border-image-repeat\",\n  ],\n\n  // CSS Fonts Module Level 3: https://www.w3.org/TR/css3-fonts/\n  font: [\n    \"font-style\",\n    \"font-variant-ligatures\",\n    \"font-variant-alternates\",\n    \"font-variant-caps\",\n    \"font-variant-numeric\",\n    \"font-variant-east-asian\",\n    \"font-variant\",\n    \"font-weight\",\n    \"font-stretch\",\n    \"font-size\",\n    \"line-height\",\n    \"font-family\",\n  ],\n  \"font-variant\": [\n    \"font-variant-ligatures\",\n    \"font-variant-alternates\",\n    \"font-variant-caps\",\n    \"font-variant-numeric\",\n    \"font-variant-east-asian\",\n  ],\n\n  // CSS Flexible Box Layout Module Level 1: https://www.w3.org/TR/css3-flexbox-1/\n  flex: [\"flex-grow\", \"flex-shrink\", \"flex-basis\"],\n  \"flex-flow\": [\"flex-direction\", \"flex-wrap\"],\n\n  // CSS Grid Layout Module Level 1: https://www.w3.org/TR/css-grid-1/\n  grid: [\n    \"grid-template-rows\",\n    \"grid-template-columns\",\n    \"grid-template-areas\",\n    \"grid-auto-rows\",\n    \"grid-auto-columns\",\n    \"grid-auto-flow\",\n  ],\n  \"grid-template\": [\n    \"grid-template-rows\",\n    \"grid-template-columns\",\n    \"grid-template-areas\",\n  ],\n  \"grid-row\": [\"grid-row-start\", \"grid-row-end\"],\n  \"grid-column\": [\"grid-column-start\", \"grid-column-end\"],\n  \"grid-area\": [\n    \"grid-row-start\",\n    \"grid-column-start\",\n    \"grid-row-end\",\n    \"grid-column-end\",\n  ],\n  \"grid-gap\": [\"grid-row-gap\", \"grid-column-gap\"],\n\n  // CSS Masking Module Level 1: https://www.w3.org/TR/css-masking/\n  mask: [\n    \"mask-image\",\n    \"mask-mode\",\n    \"mask-position\",\n    \"mask-size\",\n    \"mask-repeat\",\n    \"mask-origin\",\n    \"mask-clip\",\n  ],\n  \"mask-border\": [\n    \"mask-border-source\",\n    \"mask-border-slice\",\n    \"mask-border-width\",\n    \"mask-border-outset\",\n    \"mask-border-repeat\",\n    \"mask-border-mode\",\n  ],\n\n  // CSS Multi-column Layout Module: https://www.w3.org/TR/css3-multicol/\n  columns: [\"column-width\", \"column-count\"],\n  \"column-rule\": [\n    \"column-rule-width\",\n    \"column-rule-style\",\n    \"column-rule-color\",\n  ],\n\n  // CSS Scroll Snap Module Level 1: https://www.w3.org/TR/css-scroll-snap-1/\n  \"scroll-padding\": [\n    \"scroll-padding-top\",\n    \"scroll-padding-right\",\n    \"scroll-padding-bottom\",\n    \"scroll-padding-left\",\n  ],\n  \"scroll-padding-block\": [\n    \"scroll-padding-block-start\",\n    \"scroll-padding-block-end\",\n  ],\n  \"scroll-padding-inline\": [\n    \"scroll-padding-inline-start\",\n    \"scroll-padding-inline-end\",\n  ],\n  \"scroll-snap-margin\": [\n    \"scroll-snap-margin-top\",\n    \"scroll-snap-margin-right\",\n    \"scroll-snap-margin-bottom\",\n    \"scroll-snap-margin-left\",\n  ],\n  \"scroll-snap-margin-block\": [\n    \"scroll-snap-margin-block-start\",\n    \"scroll-snap-margin-block-end\",\n  ],\n  \"scroll-snap-margin-inline\": [\n    \"scroll-snap-margin-inline-start\",\n    \"scroll-snap-margin-inline-end\",\n  ],\n\n  // CSS Speech Module: https://www.w3.org/TR/css3-speech/\n  cue: [\"cue-before\", \"cue-after\"],\n  pause: [\"pause-before\", \"pause-after\"],\n  rest: [\"rest-before\", \"rest-after\"],\n\n  // CSS Text Decoration Module Level 3: https://www.w3.org/TR/css-text-decor-3/\n  \"text-decoration\": [\n    \"text-decoration-line\",\n    \"text-decoration-style\",\n    \"text-decoration-color\",\n  ],\n  \"text-emphasis\": [\"text-emphasis-style\", \"text-emphasis-color\"],\n\n  // CSS Animations (WD): https://www.w3.org/TR/css3-animations\n  animation: [\n    \"animation-name\",\n    \"animation-duration\",\n    \"animation-timing-function\",\n    \"animation-delay\",\n    \"animation-iteration-count\",\n    \"animation-direction\",\n    \"animation-fill-mode\",\n    \"animation-play-state\",\n  ],\n\n  // CSS Transitions (WD): https://www.w3.org/TR/css3-transitions/\n  transition: [\n    \"transition-property\",\n    \"transition-duration\",\n    \"transition-timing-function\",\n    \"transition-delay\",\n  ],\n};\n\nexport function validateNoMixedHand(style: Object) {\n  const hyphenatedProperties = Object.keys(style).reduce((acc, property) => {\n    acc[hyphenate(property)] = property;\n    return acc;\n  }, {});\n\n  const mixed = [];\n  for (const property in hyphenatedProperties) {\n    if (property in shorthandMap) {\n      for (const longhand of shorthandMap[property]) {\n        if (longhand in hyphenatedProperties) {\n          const long = hyphenatedProperties[longhand];\n          const short = hyphenatedProperties[property];\n          mixed.push({\n            shorthand: {property: short, value: style[short]},\n            longhand: {property: long, value: style[long]},\n          });\n        }\n      }\n    }\n  }\n  return mixed;\n}\n","// @flow\n\nimport test from \"tape\";\n\nimport {validateNoMixedHand} from \"../validate-no-mixed-hand.js\";\n\ntest(\"validateNoMixedHand\", t => {\n  t.deepEqual(\n    validateNoMixedHand({\n      border: \"red\",\n      borderColor: \"blue\",\n      borderTopColor: \"green\",\n    }),\n    [\n      {\n        shorthand: {property: \"border\", value: \"red\"},\n        longhand: {property: \"borderTopColor\", value: \"green\"},\n      },\n      {\n        shorthand: {property: \"border\", value: \"red\"},\n        longhand: {property: \"borderColor\", value: \"blue\"},\n      },\n      {\n        shorthand: {property: \"borderColor\", value: \"blue\"},\n        longhand: {property: \"borderTopColor\", value: \"green\"},\n      },\n    ],\n  );\n  t.end();\n});\n","// @flow strict\n\nexport default class SequentialIDGenerator {\n  prefix: string;\n  count: number;\n  offset: number;\n  msb: number;\n  power: number;\n\n  constructor(prefix: string = \"\") {\n    // ensure start with \"ae\" so \"ad\" is never produced\n    this.prefix = prefix;\n    this.count = 0;\n    this.offset = 374;\n    this.msb = 1295;\n    this.power = 2;\n  }\n\n  next() {\n    const id = this.increment().toString(36);\n    return this.prefix ? `${this.prefix}${id}` : id;\n  }\n\n  increment() {\n    const id = this.count + this.offset;\n    if (id === this.msb) {\n      this.offset += (this.msb + 1) * 9;\n      this.msb = Math.pow(36, ++this.power) - 1;\n    }\n    this.count++;\n    return id;\n  }\n}\n","// @flow strict\n\nimport SequentialIDGenerator from \"./sequential-id-generator.js\";\n\nexport class MultiCache<T> {\n  caches: {[string]: Cache<T>};\n  idGenerator: SequentialIDGenerator;\n  onNewCache: (string, Cache<T>) => any;\n  onNewValue: (cache: Cache<T>, id: string, value: T) => any;\n\n  constructor(\n    idGenerator: SequentialIDGenerator,\n    onNewCache: Function,\n    onNewValue: Function,\n  ) {\n    this.idGenerator = idGenerator;\n    this.onNewCache = onNewCache;\n    this.onNewValue = onNewValue;\n    this.caches = {};\n  }\n\n  getCache(key: string): Cache<T> {\n    if (!this.caches[key]) {\n      const cache = new Cache(this.idGenerator, this.onNewValue);\n      cache.key = key;\n      this.caches[key] = cache;\n      this.onNewCache(key, cache);\n    }\n    return this.caches[key];\n  }\n}\n\nexport class Cache<T> {\n  cache: {[string]: string};\n  idGenerator: SequentialIDGenerator;\n  key: string;\n  onNewValue: (cache: Cache<T>, id: string, value: any) => any;\n\n  constructor(\n    idGenerator: SequentialIDGenerator,\n    onNewValue: (cache: Cache<T>, id: string, value: any) => any,\n  ) {\n    this.cache = {};\n    this.idGenerator = idGenerator;\n    this.onNewValue = onNewValue;\n  }\n\n  addValue(key: string, value: T) {\n    const cached = this.cache[key];\n    if (cached) {\n      return cached;\n    }\n    const id = this.idGenerator.next();\n    this.cache[key] = id;\n    this.onNewValue(this, id, value);\n    return id;\n  }\n}\n","// @flow\n\ndeclare var __DEV__: boolean;\n\nimport hyphenate from \"./hyphenate-style-name.js\";\nimport {validateNoMixedHand} from \"./validate-no-mixed-hand.js\";\nimport prefixAll from \"inline-style-prefixer/static\";\n\nimport type {baseStyleT} from \"styletron-standard\";\n\nimport {MultiCache} from \"./cache.js\";\n\nexport default function injectStylePrefixed(\n  styleCache: MultiCache<{pseudo: string, block: string}>,\n  styles: baseStyleT,\n  media: string,\n  pseudo: string,\n) {\n  const cache = styleCache.getCache(media);\n  let classString = \"\";\n  for (const originalKey in styles) {\n    const originalVal = styles[originalKey];\n\n    if (typeof originalVal !== \"object\") {\n      // Primitive value\n      if (__DEV__) {\n        validateValueType(originalVal);\n      }\n\n      const propValPair = `${hyphenate(\n        originalKey,\n      )}:${((originalVal: any): string)}`;\n      const key = `${pseudo}${propValPair}`;\n      const cachedId = cache.cache[key];\n      if (cachedId !== void 0) {\n        // cache hit\n        classString += \" \" + cachedId;\n        continue;\n      } else {\n        // cache miss\n        let block = \"\";\n        const prefixed = prefixAll({[originalKey]: originalVal});\n        for (const prefixedKey in prefixed) {\n          const prefixedVal = prefixed[prefixedKey];\n          const prefixedValType = typeof prefixedVal;\n          if (prefixedValType === \"string\" || prefixedValType === \"number\") {\n            const prefixedPair = `${hyphenate(prefixedKey)}:${prefixedVal}`;\n            if (prefixedPair !== propValPair) {\n              block += `${prefixedPair};`;\n            }\n          } else if (Array.isArray(prefixedVal)) {\n            const hyphenated = hyphenate(prefixedKey);\n            for (let i = 0; i < prefixedVal.length; i++) {\n              const prefixedPair = `${hyphenated}:${prefixedVal[i]}`;\n              if (prefixedPair !== propValPair) {\n                block += `${prefixedPair};`;\n              }\n            }\n          }\n        }\n        block += propValPair; // ensure original prop/val is last (for hydration)\n        const id = cache.addValue(key, {pseudo, block});\n        classString += \" \" + id;\n      }\n    } else {\n      // Object value\n      if (originalKey[0] === \":\") {\n        classString +=\n          \" \" +\n          injectStylePrefixed(\n            styleCache,\n            originalVal,\n            media,\n            pseudo + originalKey,\n          );\n      } else if (originalKey.substring(0, 6) === \"@media\") {\n        classString +=\n          \" \" +\n          injectStylePrefixed(\n            styleCache,\n            originalVal,\n            originalKey.substr(7),\n            pseudo,\n          );\n      }\n    }\n  }\n\n  if (__DEV__) {\n    const conflicts = validateNoMixedHand(styles);\n    if (conflicts.length) {\n      conflicts.forEach(({shorthand, longhand}) => {\n        const short = JSON.stringify({[shorthand.property]: shorthand.value});\n        const long = JSON.stringify({[longhand.property]: longhand.value});\n        // eslint-disable-next-line no-console\n        console.warn(\n          `Styles \\`${short}\\` and \\`${long}\\` in object yielding class \"${classString.slice(\n            1,\n          )}\" may result in unexpected behavior. Mixing shorthand and longhand properties within the same style object is unsupported with atomic rendering.`,\n        );\n      });\n    }\n  }\n\n  // remove leading space\n  return classString.slice(1);\n}\n\nfunction validateValueType(value) {\n  if (\n    value === null ||\n    Array.isArray(value) ||\n    (typeof value !== \"number\" && typeof value !== \"string\")\n  ) {\n    throw new Error(`Unsupported style value: ${JSON.stringify(value)}`);\n  }\n}\n","// @flow strict\n\nimport hyphenate from \"./hyphenate-style-name.js\";\n\nexport function atomicSelector(id: string, pseudo: string): string {\n  let selector = `.${id}`;\n  if (pseudo) {\n    selector += pseudo;\n  }\n  return selector;\n}\n\nexport function keyframesToBlock(keyframes: Object): string {\n  let result = \"\";\n  for (const thing in keyframes) {\n    result += `${thing}{${declarationsToBlock(keyframes[thing])}}`;\n  }\n  return result;\n}\n\nexport function declarationsToBlock(style: Object): string {\n  let css = \"\";\n  for (const prop in style) {\n    const val = style[prop];\n    if (typeof val === \"string\" || typeof val === \"number\") {\n      css += `${hyphenate(prop)}:${val};`;\n    }\n  }\n  // trim trailing semicolon\n  return css.slice(0, -1);\n}\n\nexport function keyframesBlockToRule(id: string, block: string): string {\n  return `@keyframes ${id}{${block}}`;\n}\n\nexport function fontFaceBlockToRule(id: string, block: string): string {\n  return `@font-face{font-family:${id};${block}}`;\n}\n\nexport function styleBlockToRule(selector: string, block: string): string {\n  return `${selector}{${block}}`;\n}\n","// @flow\n\nimport SequentialIDGenerator from \"../sequential-id-generator.js\";\n\nimport type {StandardEngine} from \"styletron-standard\";\n\nimport {Cache, MultiCache} from \"../cache.js\";\n\nimport injectStylePrefixed from \"../inject-style-prefixed.js\";\n\nimport type {baseStyleT, fontFaceT, keyframesT} from \"styletron-standard\";\n\nimport {\n  styleBlockToRule,\n  atomicSelector,\n  keyframesBlockToRule,\n  declarationsToBlock,\n  keyframesToBlock,\n  fontFaceBlockToRule,\n} from \"../css.js\";\n\nexport type sheetT = {|\n  css: string,\n  attrs: {[string]: string},\n|};\n\ntype optionsT = {\n  prefix?: string,\n};\n\nclass StyletronServer implements StandardEngine {\n  styleCache: MultiCache<{pseudo: string, block: string}>;\n  keyframesCache: Cache<keyframesT>;\n  fontFaceCache: Cache<fontFaceT>;\n  styleRules: {[string]: string};\n  keyframesRules: string;\n  fontFaceRules: string;\n\n  constructor(opts?: optionsT = {}) {\n    this.styleRules = {\"\": \"\"};\n    this.styleCache = new MultiCache(\n      new SequentialIDGenerator(opts.prefix),\n      media => {\n        this.styleRules[media] = \"\";\n      },\n      (cache, id, value) => {\n        const {pseudo, block} = value;\n        this.styleRules[cache.key] += styleBlockToRule(\n          atomicSelector(id, pseudo),\n          block,\n        );\n      },\n    );\n\n    this.fontFaceRules = \"\";\n    this.fontFaceCache = new Cache(\n      new SequentialIDGenerator(opts.prefix),\n      (cache, id, value) => {\n        this.fontFaceRules += fontFaceBlockToRule(\n          id,\n          declarationsToBlock(value),\n        );\n      },\n    );\n\n    this.keyframesRules = \"\";\n    this.keyframesCache = new Cache(\n      new SequentialIDGenerator(opts.prefix),\n      (cache, id, value) => {\n        this.keyframesRules += keyframesBlockToRule(\n          id,\n          keyframesToBlock(value),\n        );\n      },\n    );\n  }\n\n  renderStyle(style: baseStyleT): string {\n    return injectStylePrefixed(this.styleCache, style, \"\", \"\");\n  }\n\n  renderFontFace(fontFace: fontFaceT): string {\n    const key = JSON.stringify(fontFace);\n    return this.fontFaceCache.addValue(key, fontFace);\n  }\n\n  renderKeyframes(keyframes: keyframesT): string {\n    const key = JSON.stringify(keyframes);\n    return this.keyframesCache.addValue(key, keyframes);\n  }\n\n  getStylesheets(): Array<sheetT> {\n    return [\n      ...(this.fontFaceRules.length\n        ? [\n            {\n              css: this.fontFaceRules,\n              attrs: {\"data-hydrate\": \"font-face\"},\n            },\n          ]\n        : []),\n      ...sheetify(this.styleRules),\n      ...(this.keyframesRules.length\n        ? [\n            {\n              css: this.keyframesRules,\n              attrs: {\"data-hydrate\": \"keyframes\"},\n            },\n          ]\n        : []),\n    ];\n  }\n\n  getStylesheetsHtml(className?: string = \"_styletron_hydrate_\") {\n    return generateHtmlString(this.getStylesheets(), className);\n  }\n\n  getCss() {\n    return (\n      this.fontFaceRules + stringify(this.styleRules) + this.keyframesRules\n    );\n  }\n}\n\nexport function generateHtmlString(sheets: Array<sheetT>, className: string) {\n  let html = \"\";\n  for (let i = 0; i < sheets.length; i++) {\n    const sheet = sheets[i];\n    const {class: originalClassName, ...rest} = sheet.attrs;\n    const attrs = {\n      class: originalClassName\n        ? `${className} ${originalClassName}`\n        : className,\n      ...rest,\n    };\n    html += `<style${attrsToString(attrs)}>${sheet.css}</style>`;\n  }\n  return html;\n}\n\nfunction attrsToString(attrs) {\n  let result = \"\";\n  for (const attr in attrs) {\n    const value = attrs[attr];\n    if (value === true) {\n      result += \" \" + attr;\n    } else if (value !== false) {\n      result += ` ${attr}=\"${value}\"`;\n    }\n  }\n  return result;\n}\n\nfunction stringify(styleRules) {\n  let result = \"\";\n  for (const media in styleRules) {\n    const rules = styleRules[media];\n    if (media) {\n      result += `@media ${media}{${rules}}`;\n    } else {\n      result += rules;\n    }\n  }\n  return result;\n}\n\nfunction sheetify(styleRules) {\n  const sheets = [];\n  for (const media in styleRules) {\n    // omit media attribute if empty\n    const attrs = media ? {media} : {};\n    sheets.push({css: styleRules[media], attrs});\n  }\n  return sheets;\n}\n\nexport default StyletronServer;\n","// @flow\n\nimport test from \"tape\";\nimport Styletron from \"../server.js\";\n\ntest(\"StyletronServer toCss\", t => {\n  const styletron = new Styletron();\n  t.equal(styletron.getCss(), \"\", \"returns empty string when no styles\");\n  injectFixtureStyles(styletron);\n  t.equal(\n    styletron.getCss(),\n    \".ae{color:red}.af{color:green}.ai:hover{display:none}.aj{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ak{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex}@media (max-width: 800px){.ag{color:green}.ah:hover{color:green}}\",\n  );\n  injectFixtureStyles(styletron);\n  t.equal(\n    styletron.getCss(),\n    \".ae{color:red}.af{color:green}.ai:hover{display:none}.aj{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ak{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex}@media (max-width: 800px){.ag{color:green}.ah:hover{color:green}}\",\n  );\n  injectFixtureKeyframes(styletron);\n  t.equal(\n    styletron.getCss(),\n    \".ae{color:red}.af{color:green}.ai:hover{display:none}.aj{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ak{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex}@media (max-width: 800px){.ag{color:green}.ah:hover{color:green}}@keyframes ae{from{color:purple}50%{color:yellow}to{color:orange}}\",\n  );\n  t.end();\n});\n\ntest(\"StyletronServer getStylesheets\", t => {\n  const styletron = new Styletron();\n  t.deepEqual(\n    styletron.getStylesheets(),\n    [{css: \"\", attrs: {}}],\n    \"no styles yields array with single empty stylesheet\",\n  );\n  injectFixtureStyles(styletron);\n  t.deepEqual(styletron.getStylesheets(), [\n    {\n      css:\n        \".ae{color:red}.af{color:green}.ai:hover{display:none}.aj{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ak{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex}\",\n      attrs: {},\n    },\n    {\n      css: \".ag{color:green}.ah:hover{color:green}\",\n      attrs: {media: \"(max-width: 800px)\"},\n    },\n  ]);\n  injectFixtureKeyframes(styletron);\n  t.deepEqual(styletron.getStylesheets(), [\n    {\n      css:\n        \".ae{color:red}.af{color:green}.ai:hover{display:none}.aj{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ak{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex}\",\n      attrs: {},\n    },\n    {\n      css: \".ag{color:green}.ah:hover{color:green}\",\n      attrs: {media: \"(max-width: 800px)\"},\n    },\n    {\n      css: \"@keyframes ae{from{color:purple}50%{color:yellow}to{color:orange}}\",\n      attrs: {\"data-hydrate\": \"keyframes\"},\n    },\n  ]);\n  injectFixtureFontFace(styletron);\n  t.deepEqual(styletron.getStylesheets(), [\n    {\n      css: \"@font-face{font-family:ae;src:local('Roboto')}\",\n      attrs: {\"data-hydrate\": \"font-face\"},\n    },\n    {\n      css:\n        \".ae{color:red}.af{color:green}.ai:hover{display:none}.aj{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ak{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex}\",\n      attrs: {},\n    },\n    {\n      css: \".ag{color:green}.ah:hover{color:green}\",\n      attrs: {media: \"(max-width: 800px)\"},\n    },\n    {\n      css: \"@keyframes ae{from{color:purple}50%{color:yellow}to{color:orange}}\",\n      attrs: {\"data-hydrate\": \"keyframes\"},\n    },\n  ]);\n  t.end();\n});\n\ntest(\"StyletronServer getStylesheetsHtml \", t => {\n  const styletron = new Styletron();\n  t.equal(\n    styletron.getStylesheetsHtml(),\n    '<style class=\"_styletron_hydrate_\"></style>',\n    \"returns single empty stylesheet when no styles\",\n  );\n\n  injectFixtureStyles(styletron);\n  t.equal(\n    styletron.getStylesheetsHtml(),\n    '<style class=\"_styletron_hydrate_\">.ae{color:red}.af{color:green}.ai:hover{display:none}.aj{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ak{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex}</style><style class=\"_styletron_hydrate_\" media=\"(max-width: 800px)\">.ag{color:green}.ah:hover{color:green}</style>',\n  );\n  injectFixtureKeyframes(styletron);\n  t.equal(\n    styletron.getStylesheetsHtml(),\n    '<style class=\"_styletron_hydrate_\">.ae{color:red}.af{color:green}.ai:hover{display:none}.aj{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ak{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex}</style><style class=\"_styletron_hydrate_\" media=\"(max-width: 800px)\">.ag{color:green}.ah:hover{color:green}</style><style class=\"_styletron_hydrate_\" data-hydrate=\"keyframes\">@keyframes ae{from{color:purple}50%{color:yellow}to{color:orange}}</style>',\n  );\n  injectFixtureFontFace(styletron);\n  t.equal(\n    styletron.getStylesheetsHtml(),\n    '<style class=\"_styletron_hydrate_\" data-hydrate=\"font-face\">@font-face{font-family:ae;src:local(\\'Roboto\\')}</style><style class=\"_styletron_hydrate_\">.ae{color:red}.af{color:green}.ai:hover{display:none}.aj{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ak{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex}</style><style class=\"_styletron_hydrate_\" media=\"(max-width: 800px)\">.ag{color:green}.ah:hover{color:green}</style><style class=\"_styletron_hydrate_\" data-hydrate=\"keyframes\">@keyframes ae{from{color:purple}50%{color:yellow}to{color:orange}}</style>',\n  );\n  t.end();\n});\n\ntest(\"StyletronServer prefix option\", t => {\n  const styletron = new Styletron({prefix: \"foo_\"});\n  t.equal(styletron.renderStyle({color: \"red\"}), \"foo_ae\");\n  t.equal(injectFixtureFontFace(styletron), \"foo_ae\");\n  t.equal(injectFixtureKeyframes(styletron), \"foo_ae\");\n  t.deepEqual(styletron.getStylesheets(), [\n    {\n      css: \"@font-face{font-family:foo_ae;src:local('Roboto')}\",\n      attrs: {\"data-hydrate\": \"font-face\"},\n    },\n    {css: \".foo_ae{color:red}\", attrs: {}},\n    {\n      css:\n        \"@keyframes foo_ae{from{color:purple}50%{color:yellow}to{color:orange}}\",\n      attrs: {\"data-hydrate\": \"keyframes\"},\n    },\n  ]);\n  t.end();\n});\n\nfunction injectFixtureStyles(styletron) {\n  styletron.renderStyle({color: \"red\"});\n  styletron.renderStyle({color: \"green\"});\n  styletron.renderStyle({\n    \"@media (max-width: 800px)\": {\n      color: \"green\",\n    },\n  });\n  styletron.renderStyle({\n    \"@media (max-width: 800px)\": {\n      \":hover\": {\n        color: \"green\",\n      },\n    },\n  });\n  styletron.renderStyle({\n    \":hover\": {\n      display: \"none\",\n    },\n  });\n  styletron.renderStyle({\n    userSelect: \"none\",\n  });\n  styletron.renderStyle({\n    display: \"flex\",\n  });\n}\n\nfunction injectFixtureKeyframes(styletron) {\n  return styletron.renderKeyframes({\n    from: {\n      color: \"purple\",\n    },\n    \"50%\": {\n      color: \"yellow\",\n    },\n    to: {\n      color: \"orange\",\n    },\n  });\n}\n\nfunction injectFixtureFontFace(styletron) {\n  return styletron.renderFontFace({\n    src: \"local('Roboto')\",\n  });\n}\n"],"names":["uppercasePattern","msPattern","cache","hyphenateStyleName","prop","replace","toLowerCase","shorthandMap","validateNoMixedHand","style","hyphenatedProperties","Object","keys","reduce","acc","property","hyphenate","mixed","longhand","long","short","push","test","t","deepEqual","end","SequentialIDGenerator","prefix","count","offset","msb","power","id","increment","toString","Math","pow","MultiCache","idGenerator","onNewCache","onNewValue","caches","key","Cache","value","cached","next","injectStylePrefixed","styleCache","styles","media","pseudo","getCache","classString","originalKey","originalVal","propValPair","cachedId","block","prefixed","prefixAll","prefixedKey","prefixedVal","prefixedValType","prefixedPair","Array","isArray","hyphenated","i","length","addValue","substring","substr","conflicts","forEach","JSON","stringify","shorthand","warn","slice","validateValueType","Error","atomicSelector","selector","keyframesToBlock","keyframes","result","thing","declarationsToBlock","css","val","keyframesBlockToRule","fontFaceBlockToRule","styleBlockToRule","StyletronServer","opts","styleRules","fontFaceRules","fontFaceCache","keyframesRules","keyframesCache","fontFace","sheetify","className","generateHtmlString","getStylesheets","sheets","html","sheet","attrs","originalClassName","rest","attrsToString","attr","rules","styletron","Styletron","equal","getCss","getStylesheetsHtml","renderStyle","injectFixtureFontFace","injectFixtureKeyframes","injectFixtureStyles","renderKeyframes","renderFontFace"],"mappings":"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"}
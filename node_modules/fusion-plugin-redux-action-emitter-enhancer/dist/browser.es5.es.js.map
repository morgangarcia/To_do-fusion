{"version":3,"file":"browser.es5.es.js","sources":["../src/index.js"],"sourcesContent":["/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\n/* eslint-env browser,node */\n\nimport type {StoreEnhancer, StoreCreator, Store} from 'redux';\n\nimport {createPlugin} from 'fusion-core';\nimport {UniversalEventsToken} from 'fusion-plugin-universal-events';\n\ntype ExtractReturnType = <V>(() => V) => V;\ntype IEmitter = $Call<typeof UniversalEventsToken, ExtractReturnType>;\n\nconst plugin = createPlugin({\n  deps: {\n    emitter: UniversalEventsToken,\n  },\n  provides({emitter}: {emitter: IEmitter}) {\n    if (__DEV__ && !emitter) {\n      throw new Error(`emitter is required, but was: ${emitter}`);\n    }\n\n    const service: StoreEnhancer<*, *, *> = (\n      createStore: StoreCreator<*, *, *>\n    ) => (...args: *) => {\n      const store: Store<*, *, *> = createStore(...args);\n      return {\n        ...store,\n        dispatch: action => {\n          // $FlowFixMe\n          emitter.from(store.ctx).emit('redux-action-emitter:action', action);\n          return store.dispatch(action);\n        },\n      };\n    };\n    return service;\n  },\n});\n\nexport default plugin;\n"],"names":["plugin","createPlugin","UniversalEventsToken","emitter","Error","service","createStore","store","from","ctx","emit","action","dispatch"],"mappings":";;;;;;;;;;;;;;;;AAYA,AAMA,IAAMA,SAASC,aAAa;QACpB;aACKC;GAFe;UAAA,0BAIe;QAA/BC,OAA+B,QAA/BA,OAA+B;;QACnC,yCAAW,CAACA,OAAhB,EAAyB;YACjB,IAAIC,KAAJ,oCAA2CD,OAA3C,CAAN;;;QAGIE,UAAkC,SAAlCA,OAAkC,CACtCC,WADsC;aAEnC,YAAgB;YACbC,QAAwBD,oCAA9B;iCAEKC,KADL;oBAEY,0BAAU;;oBAEVC,IAAR,CAAaD,MAAME,GAAnB,EAAwBC,IAAxB,CAA6B,6BAA7B,EAA4DC,MAA5D;mBACOJ,MAAMK,QAAN,CAAeD,MAAf,CAAP;;;OATkC;KAAxC;;WAaON,OAAP;;CAtBW,CAAf;;;;"}
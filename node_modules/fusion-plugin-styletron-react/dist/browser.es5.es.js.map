{"version":3,"file":"browser.es5.es.js","sources":["../src/legacy-provider.js","../src/inject-declaration-compat-mixin.js","../src/server.js","../src/browser.js","../src/index.js"],"sourcesContent":["import React from 'react';\n\n/**\n * Provides styletron instance via old context API\n */\n\nclass LegacyStyletronProvider extends React.Component {\n  getChildContext() {\n    return {styletron: this.styletron};\n  }\n  constructor(props, context) {\n    super(props, context);\n    this.styletron = props.value;\n  }\n  render() {\n    return React.Children.only(this.props.children);\n  }\n}\n\nLegacyStyletronProvider.childContextTypes = {\n  styletron: noop,\n};\n\nexport default LegacyStyletronProvider;\n\nfunction noop() {}\n","export const injectDeclarationCompatMixin = Base =>\n  class extends Base {\n    injectDeclaration({prop, val, media, pseudo}) {\n      let style = {[prop]: val};\n      if (pseudo) {\n        style = {\n          [pseudo]: style,\n        };\n      }\n      if (media) {\n        style = {\n          [media]: style,\n        };\n      }\n      return this.renderStyle(style);\n    }\n  };\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\n/* eslint-env node */\nimport React from 'react';\nimport {createPlugin, dangerouslySetHTML} from 'fusion-core';\nimport type {FusionPlugin} from 'fusion-core';\n\nimport {Provider as StyletronProvider} from 'styletron-react';\nimport {Server as Styletron} from 'styletron-engine-atomic';\n\nimport LegacyProvider from './legacy-provider.js';\nimport {injectDeclarationCompatMixin} from './inject-declaration-compat-mixin.js';\n\nconst StyletronCompat = injectDeclarationCompatMixin(Styletron);\n\nconst plugin =\n  __NODE__ &&\n  createPlugin({\n    middleware: () => (ctx, next) => {\n      if (ctx.element) {\n        const engine = new StyletronCompat();\n\n        ctx.element = (\n          <StyletronProvider value={engine}>\n            <LegacyProvider value={engine}>{ctx.element}</LegacyProvider>\n          </StyletronProvider>\n        );\n\n        return next().then(() => {\n          const stylesForHead = engine.getStylesheetsHtml();\n          ctx.template.head.push(dangerouslySetHTML(stylesForHead));\n        });\n      } else {\n        return next();\n      }\n    },\n  });\n\nexport default ((plugin: any): FusionPlugin<*, *>);\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\n/* eslint-env browser */\nimport React from 'react';\nimport {createPlugin} from 'fusion-core';\nimport type {FusionPlugin} from 'fusion-core';\n\nimport {Provider as StyletronProvider} from 'styletron-react';\nimport {Client as Styletron} from 'styletron-engine-atomic';\n\nimport LegacyProvider from './legacy-provider.js';\nimport {injectDeclarationCompatMixin} from './inject-declaration-compat-mixin.js';\n\nconst StyletronCompat = injectDeclarationCompatMixin(Styletron);\n\nlet engine;\n\nconst plugin =\n  __BROWSER__ &&\n  createPlugin({\n    middleware: () => (ctx, next) => {\n      if (ctx.element) {\n        if (!engine) {\n          engine = new StyletronCompat({\n            hydrate: document.getElementsByClassName('_styletron_hydrate_'),\n          });\n        }\n        ctx.element = (\n          <StyletronProvider value={engine}>\n            <LegacyProvider value={engine}>{ctx.element}</LegacyProvider>\n          </StyletronProvider>\n        );\n      }\n\n      return next();\n    },\n  });\n\nexport default ((plugin: any): FusionPlugin<*, *>);\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\n/* eslint-env browser */\nimport {\n  styled,\n  withStyle,\n  withStyleDeep,\n  withTransform,\n  withWrapper,\n} from 'styletron-react';\n\nimport server from './server';\nimport browser from './browser';\n\ndeclare var __NODE__: Boolean;\n\nexport default (__NODE__ ? server : browser);\nexport {styled, withStyle, withStyleDeep, withTransform, withWrapper};\n"],"names":["LegacyStyletronProvider","getChildContext","styletron","props","context","value","render","React","Children","only","children","Component","childContextTypes","noop","injectDeclarationCompatMixin","injectDeclaration","prop","val","media","pseudo","style","renderStyle","Base","StyletronCompat","Styletron","engine","plugin","createPlugin","ctx","next","element","document","getElementsByClassName","StyletronProvider","LegacyProvider","browser"],"mappings":";;;;;;;;AAAA,AAEA;;;;IAIMA;;;;;;;SACJC,6CAAkB;WACT;iBAAY,KAAKC;KAAxB;;;mCAEUC,KAAZ,EAAmBC,OAAnB,EAA4B;;;wCACpBD,KAAN,EAAaC,OAAb;UACKF,SAAL,GAAiBC,MAAME,KAAvB;;;;SAEFC,2BAAS;WACAC,MAAMC,QAAN,CAAeC,IAAf,CAAoB,KAAKN,KAAL,CAAWO,QAA/B,CAAP;;;;EATkCH,MAAMI;;AAa5CX,wBAAwBY,iBAAxB,GAA4C;aAC/BC;CADb;AAIA,AAEA,SAASA,IAAT,GAAgB;;;;ACzBhB,AAAO,IAAMC,+BAA+B,SAA/BA,4BAA+B;;;;;;;;;;;;aAExCC,iBAFwC,oCAEM;;;YAA3BC,IAA2B,QAA3BA,IAA2B;YAArBC,GAAqB,QAArBA,GAAqB;YAAhBC,KAAgB,QAAhBA,KAAgB;YAATC,MAAS,QAATA,MAAS;YACxCC,6BAAUJ,IAAV,IAAiBC,GAAjB,SAAJ;;YACIE,MAAJ,EAAY;;;yCAEPA,MADH,IACYC,KADZ;;;YAIEF,KAAJ,EAAW;;;yCAENA,KADH,IACWE,KADX;;;eAIK,KAAKC,WAAL,CAAiBD,KAAjB,CAAP;OAdsC;;;MAC5BE,IAD4B;;CAArC;;ACAP;;;;;;;;;AASA,AAUA,IAAMC,kBAAkBT,6BAA6BU,MAA7B,CAAxB;;ACnBA;;;;;;;;;AASA,AAUA,IAAMD,oBAAkBT,6BAA6BU,MAA7B,CAAxB;AAEA,IAAIC,MAAJ;AAEA,IAAMC,WACJ,QACAC,aAAa;cACC;WAAM,UAACC,GAAD,EAAMC,IAAN,EAAe;UAC3BD,IAAIE,OAAR,EAAiB;YACX,CAACL,MAAL,EAAa;mBACF,IAAIF,iBAAJ,CAAoB;qBAClBQ,SAASC,sBAAT,CAAgC,qBAAhC;WADF,CAAT;;;YAIEF,OAAJ,GACE,oBAACG,QAAD;iBAA0BR;WACxB,oBAACS,uBAAD;iBAAuBT;WAASG,IAAIE,OAApC,CADF,CADF;;;aAOKD,MAAP;KAdU;;CADd,CAFF;;ACvBA;;;;;;;;;AASA,AAaA,YAAoCM,QAApC;;;;"}